---
phase: 04-frontend-state
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - src/lib/hooks/use-kpi-mutations.ts
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "useOverrideProgress sends 'progressPercentage' to match API expectation"
  artifacts:
    - path: "src/lib/hooks/use-kpi-mutations.ts"
      provides: "Correct API field name in postProgressOverride"
      contains: "progressPercentage: request.progress"
  key_links:
    - from: "use-kpi-mutations.ts"
      to: "/api/vision-kpis/[id]/override"
      via: "POST with { progressPercentage, reason }"
      pattern: "progressPercentage:"
---

<objective>
Fix API field name mismatch in useOverrideProgress hook.

Purpose: The hook currently sends 'progress' but the API expects 'progressPercentage'. This is a blocker bug that causes 400 errors.

Output: Working useOverrideProgress mutation that sends correct field name.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/04-frontend-state/04-VERIFICATION.md

**Gap being closed:**
- artifact_issue: "useOverrideProgress sends wrong field name to API"
- severity: blocker
- files: src/lib/hooks/use-kpi-mutations.ts:180 sends { progress }
- API expects: { progressPercentage, reason }
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix field name in postProgressOverride</name>
  <files>src/lib/hooks/use-kpi-mutations.ts</files>
  <action>
    In the postProgressOverride function (around line 175-191), change the body field from:

    ```typescript
    body: JSON.stringify({
      progress: request.progress,
      reason: request.reason,
    }),
    ```

    To:

    ```typescript
    body: JSON.stringify({
      progressPercentage: request.progress,
      reason: request.reason,
    }),
    ```

    This maps the hook's internal 'progress' property (0-100) to the API's expected 'progressPercentage' field name.
  </action>
  <verify>
    1. `npx tsc --noEmit` passes
    2. Grep confirms change: `grep -n "progressPercentage:" src/lib/hooks/use-kpi-mutations.ts`
  </verify>
  <done>postProgressOverride sends progressPercentage field matching API contract</done>
</task>

</tasks>

<verification>
- [ ] TypeScript compiles without errors
- [ ] Field name 'progressPercentage' appears in postProgressOverride function
- [ ] Field name 'progress' removed from postProgressOverride JSON body
</verification>

<success_criteria>
useOverrideProgress hook sends correct field name to /api/vision-kpis/[id]/override endpoint, preventing 400 errors.
</success_criteria>

<output>
After completion, create `.planning/phases/04-frontend-state/04-03-SUMMARY.md`
</output>
